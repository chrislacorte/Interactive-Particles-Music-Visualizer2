<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Interactive Particles Music Visualizer in Three.js | Codrops</title>
    <meta
      name="description"
      content="Demo for the tutorial where you will learn how to build a particles music visualizer with Three.js, with techniques covering audio synchronization and 3D visual effects, inspired by ARKx's work for Coala Music's website."
    />
    <meta
      name="keywords"
      content="Three.js, audio-reactive visuals, WebGL, JavaScript, 3D visual effects, sound synchronization, audio visualization, visualizer, dynamic particles, web development, ARKx, tutorial"
    />
    <meta name="author" content="Tiago Canzian for Codrops" />
    <link rel="shortcut icon" href="img/favicon.ico" />
    <link rel="stylesheet" href="./src/scss/style.scss" />
    <!-- MediaPipe Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script>
      document.documentElement.className = 'js'
    </script>
    <script type="module" defer src="./src/js/index.js"></script>
  </head>
  <body class="demo-1">
    <main>
      <div class="content"></div>
      
      <!-- Hidden video and canvas for MediaPipe -->
      <video id="webcam" style="display: none;" autoplay muted playsinline></video>
      <canvas id="handCanvas" style="display: none;"></canvas>
      <canvas id="handTrackingOverlay" style="display: none; position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1000;"></canvas>
      
      <div class="user_interaction">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          version="1.1"
          x="0px"
          y="0px"
          viewBox="0 0 100 125"
          style="enable-background: new 0 0 100 100"
          xml:space="preserve"
        >
          <g fill="#FFFFFF">
            <path
              d="M66.6,55.2l-7.4,4.4c-0.5,0.3-0.6,0.9-0.4,1.4c0.3,0.5,0.9,0.6,1.4,0.4l7.4-4.4c2.5-1.5,4-4.1,4-6.9s-1.5-5.5-4-6.9   L46.1,30.4c-2.5-1.5-5.5-1.5-8.1-0.1c-2.5,1.5-4.1,4.1-4.1,7v25.4c0,2.9,1.5,5.5,4.1,7c1.3,0.7,2.6,1.1,4,1.1   c1.4,0,2.8-0.4,4.1-1.1l8.2-4.8c0.5-0.3,0.6-0.9,0.4-1.4c-0.3-0.5-0.9-0.6-1.4-0.4l-8.2,4.8C43.2,69,41,69,39,67.9   c-1.9-1.1-3-3.1-3-5.2V37.3c0-2.2,1.1-4.2,3-5.2c1.9-1.1,4.2-1.1,6.1,0l21.5,12.7c1.9,1.1,3,3,3,5.2S68.5,54.1,66.6,55.2z"
            />
            <path
              d="M50,93c9,0,17.7-2.8,25-8c0.5-0.3,0.6-0.9,0.2-1.4c-0.3-0.4-0.9-0.6-1.4-0.2c-7,5-15.2,7.6-23.8,7.6C27.4,91,9,72.6,9,50   S27.4,9,50,9s41,18.4,41,41c0,10.4-3.9,20.4-11,28c-0.4,0.4-0.4,1,0,1.4c0.4,0.4,1,0.4,1.4,0C88.9,71.4,93,60.9,93,50   C93,26.3,73.7,7,50,7S7,26.3,7,50S26.3,93,50,93z"
            />
          </g>
        </svg>
        <p>Click to Start</p>
      </div>
      
      <!-- Top Menu -->
      <div class="top-menu" id="topMenu" style="display: none;">
        <button class="webcam-btn" id="webcamBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
            <circle cx="12" cy="13" r="4"></circle>
          </svg>
          <span>Activate Handtracking</span>
        </button>
        
        <button class="gesture-info-btn" id="gestureInfoBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          <span>Gesture Overview</span>
        </button>
      </div>
      
      <div class="bottom-menu" id="bottomMenu" style="display: none;">
        <div class="menu-row-1">
          <button class="record-btn" id="recordBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <circle cx="12" cy="12" r="3" fill="currentColor"></circle>
            </svg>
            <span>Record</span>
          </button>
          
          <div class="playback-controls">
            <button class="playback-btn" id="playBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="5,3 19,12 5,21"></polygon>
              </svg>
              <span>Play</span>
            </button>
            <button class="playback-btn" id="stopBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="6" y="6" width="12" height="12"></rect>
              </svg>
              <span>Stop</span>
            </button>
          </div>
        </div>
        
        <div class="color-section">
          <div class="color-label">Color Selection</div>
          <div class="color-pickers-wrapper">
            <div class="color-picker-container">
              <div class="color-indicator" id="colorIndicator1" title="Click to enter hex color"></div>
              <input type="range" class="color-slider" id="colorSlider1" min="0" max="360" value="300">
            </div>
            <div class="color-picker-container">
              <div class="color-indicator" id="colorIndicator2" title="Click to enter hex color"></div>
              <input type="range" class="color-slider" id="colorSlider2" min="0" max="360" value="180">
            </div>
          </div>
        </div>
        
        <div class="modes-section">
          <button class="mode-btn active" data-mode="particles">Particles</button>
          <button class="mode-btn" data-mode="circles">Circles</button>
          <button class="mode-btn" data-mode="lines">Lines</button>
          <button class="mode-btn" data-mode="anomaly">Anomaly</button>
          <button class="mode-btn" data-mode="waves">Waves</button>
          <button class="mode-btn" data-mode="spiral">Spiral</button>
          <button class="mode-btn" data-mode="paint">Paint</button>
          <button class="mode-btn" data-mode="conductor">Conductor</button>
        </div>
        
        <div class="hide-section">
          <div class="toggle-container">
            <label class="toggle-switch">
              <input type="checkbox" id="hideToggle">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">hide</span>
          </div>
        </div>
      </div>
      
      <!-- Show UI Button (appears when UI is hidden) -->
      <button class="show-ui-btn" id="showUIBtn" style="display: none;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
        <span>Show UI</span>
      </button>
      
      <!-- Gesture Overview Slideout -->
      <div class="gesture-slideout" id="gestureSlideout">
        <div class="gesture-slideout-content">
          <div class="gesture-header">
            <h2>Gesture Overview</h2>
            <button class="close-gesture" id="closeGesture">&times;</button>
          </div>
          
          <div class="gesture-list">
            <div class="gesture-item">
              <div class="gesture-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="m3 17 6-6 4 4 8-8"></path>
                  <path d="m21 21-2-2"></path>
                  <path d="m16 16-2-2"></path>
                </svg>
              </div>
              <div class="gesture-info">
                <h3>Paint Mode</h3>
                <p>Point with your index finger to paint with particles. Move your finger around the screen and watch as particles are pushed away from your finger position, creating dynamic painting effects.</p>
              </div>
            </div>
            
            <div class="gesture-item">
              <div class="gesture-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2v20"></path>
                  <path d="m8 6 4-4 4 4"></path>
                  <path d="m8 18 4 4 4 4"></path>
                </svg>
              </div>
              <div class="gesture-info">
                <h3>Conductor Mode</h3>
                <p>Move your hand up and down like a conductor to control vertical wave patterns. The height of your hand determines the amplitude of the wave effect across the particles.</p>
              </div>
            </div>
            
            <div class="gesture-item">
              <div class="gesture-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="m12 1 1.27 2.76L16 2l2 2-1.76 2.73L19 8l-1 1.73-2.76-1.27L16 11l-2.73-1.27L12 12l-1.27-2.73L8 11l-2-2 1.76-2.73L5 8l1-1.73 2.76 1.27L8 5l2.73 1.27z"></path>
                </svg>
              </div>
              <div class="gesture-info">
                <h3>Zoom Gesture</h3>
                <p>Pinch with your thumb and index finger to zoom in and out of the visualization. Bring fingers together to zoom out, spread apart to zoom in.</p>
              </div>
            </div>
            
            <div class="gesture-item">
              <div class="gesture-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                  <circle cx="12" cy="13" r="4"></circle>
                </svg>
              </div>
              <div class="gesture-info">
                <h3>Hand Tracking</h3>
                <p>Enable webcam to activate hand tracking. Your hand movements will be detected and translated into real-time visual effects that sync with the music.</p>
              </div>
            </div>
          </div>
          
          <div class="gesture-tips">
            <h3>Tips for Best Results</h3>
            <ul>
              <li>Ensure good lighting for optimal hand detection</li>
              <li>Keep your hand clearly visible in the webcam view</li>
              <li>Make deliberate, smooth movements for best response</li>
              <li>Select "Paint" or "Conductor" mode to activate gesture controls</li>
              <li>Try different gesture combinations with various visual modes</li>
            </ul>
          </div>
        </div>
      </div>
      
      <!-- Hex Color Input Tooltip -->
      <div class="hex-tooltip" id="hexTooltip" style="display: none;">
        <input type="text" id="hexInput" placeholder="#FF00FF" maxlength="7">
        <button id="applyHex">Apply</button>
        <button id="cancelHex">Cancel</button>
      </div>
    </main>
  </body>
</html>
